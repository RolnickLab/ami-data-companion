#:import kivy kivy
#:import win kivy.core.window

<BBox>
    pos: (0, 0)
    size: (300, 300)
    canvas.after:
        PushMatrix:
        Translate:
            # The Image is centered in the widget with margins. This sets the xy to be the bottom left corner of the actual image content
            xy: (self.parent.x + (self.parent.width - self.parent.norm_image_size[0])/2, self.parent.y + (self.parent.height - self.parent.norm_image_size[1])/2) if self.parent else (0, 0)
        Scale:
            origin: 0,0
            x: self.parent.norm_image_size[0] / self.parent.texture_size[0] if self.parent and self.parent.texture_size[0] > 0 else 1
            y: self.parent.norm_image_size[1] / self.parent.texture_size[1] if self.parent and self.parent.texture_size[1] > 0 else 1
        Color:
            rgba: .1, .1, 1, .9
        Line:
            width: 5.
            # rectangle: (0, 0, self.parent.norm_image_size[0]/2, self.parent.norm_image_size[1]/2)
            rectangle: (0, 0, self.width, self.height)
        PopMatrix:
    Label:
        name: "bbox_label"
        pos: (self.parent.x, self.parent.y)
        text: 'Rectangle'



<PreviewWindow>


<Controls>
    size_hint_y: 0.1
    Button:
        text: "Exit"
        on_press: self.parent.parent.parent.manager.current = "menu"
    Button:
        text: "< Previous"
        on_press: self.parent.parent.ids.image_preview.prev_sample() 
    Button:
        text: "Next >"   
        on_press: self.parent.parent.ids.image_preview.next_sample() 


<ImagePlaybackScreen>:
    id: playback_screen
    ImagePlaybackLayout:
        id: playback_layout


<ImagePlaybackLayout>
    orientation: "vertical"
    PreviewWindow:
        id: image_preview 
    Controls:
        id: controls 
